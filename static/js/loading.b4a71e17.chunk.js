(this["webpackJsonpneural-food-web"]=this["webpackJsonpneural-food-web"]||[]).push([[2],{135:function(t,n,e){"use strict";e.d(n,"a",(function(){return o})),e.d(n,"c",(function(){return s})),e.d(n,"b",(function(){return u}));var r=e(220),c=e(218),a=(e(0),e(1)),i=function(t){var n=t.type;return Object(a.jsx)(c.a,{icon:n})},o=function(){return Object(a.jsx)(i,{type:r.b})},s=function(){return Object(a.jsx)(i,{type:r.c})},u=function(){return Object(a.jsx)(i,{type:r.a})}},136:function(t,n,e){"use strict";e.d(n,"a",(function(){return a})),e.d(n,"b",(function(){return i}));var r=e(2),c=e(5),a=Object(r.b)("client/change-stage",(function(t,n){setTimeout((function(){setTimeout((function(){n.dispatch(c.a.actions.changeStage(t.stage))}),t.ms)}))})),i=Object(r.b)("client/set-sbapshot",(function(t,n){var e=t.snapshot,r=t.nextStage;n.dispatch(c.a.actions.setSnapshot(e)),n.dispatch(a({stage:r,ms:0}))}))},166:function(t,n,e){"use strict";e.d(n,"a",(function(){return l}));var r,c,a=e(10),i=e(11),o=Object(i.c)(r||(r=Object(a.a)(["\n  from {\n    opacity: 0;\n  }\n\n  to {\n    opacity: 1;\n  }\n"]))),s={FadeIn:i.b.div(c||(c=Object(a.a)(["\n    animation: "," ","s linear 1;\n"])),o,(function(t){return t.duration}))},u=(e(0),e(1)),l=function(t){var n=t.children;return Object(u.jsx)(s.FadeIn,{duration:1,style:{width:"100%",height:"100%"},children:n})}},167:function(t,n,e){"use strict";e.d(n,"a",(function(){return b}));var r=e(44),c=e.n(r),a=e(45),i=e(37),o=e(39),s=e(276),u=e(0),l=e.n(u),d=function t(n){return Object(o.a)(this,t),s.c.l1l2(n)};d.className="L2",s.d.registerClass(d);var b=function(t){var n=l.a.useState(),e=Object(i.a)(n,2),r=e[0],o=e[1];return l.a.useEffect((function(){t&&s.b({load:function(){var n=Object(a.a)(c.a.mark((function n(){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t);case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}).then((function(t){o(t)})).catch((function(t){console.error(t)}))}),[t]),r}},229:function(t,n){},275:function(t,n,e){"use strict";e.d(n,"a",(function(){return d}));var r=e(50),c=e(44),a=e.n(c),i=e(45),o=e(37),s=e(167),u=e(276),l=e(0),d=function(t,n,e){var r=Object(s.a)(t),c=l.useState([]),u=Object(o.a)(c,2),d=u[0],f=u[1];return l.useEffect((function(){(function(){var t=Object(i.a)(a.a.mark((function t(){var c,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=r&&null!=n&&null!=e){t.next=2;break}return t.abrupt("return",[]);case 2:return t.next=4,b(n,r);case 4:c=t.sent,i=c.map((function(t,n){return{accuracy:t,label:e[n]}})),f(i.sort((function(t,n){return n.accuracy-t.accuracy})));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()().catch()}),[r,n,f,e]),d},b=function(){var t=Object(i.a)(a.a.mark((function t(n,e){var c,i,o,s,l,d,b;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(n);case 2:return c=t.sent,t.next=5,u.a.fromPixelsAsync(c);case 5:return i=t.sent,o=i.expandDims(0),t.next=9,e.predict(o);case 9:if(s=t.sent,!Array.isArray(s)){t.next=17;break}return l=s.map((function(t){return t.data()})),t.next=14,Promise.all(l);case 14:return d=t.sent,b=d.map((function(t){return Array.from(t)})),t.abrupt("return",b.reduce((function(t,n){return[].concat(Object(r.a)(t),Object(r.a)(n))})));case 17:return t.t0=Array,t.next=20,s.data();case 20:return t.t1=t.sent,t.abrupt("return",t.t0.from.call(t.t0,t.t1));case 22:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),f=function(t){var n=document.createElement("img");return n.src=URL.createObjectURL(t),new Promise((function(t){n.onload=function(){t(n)}}))}},302:function(t,n,e){"use strict";var r=e(229);e.o(r,"usePredictions")&&e.d(n,"usePredictions",(function(){return r.usePredictions}));e(167);var c=e(275);e.d(n,"usePredictions",(function(){return c.a}))},307:function(t,n){},308:function(t,n){},316:function(t,n){},337:function(t,n){},338:function(t,n){},339:function(t,n,e){"use strict";e.r(n);var r=e(12),c=e(44),a=e.n(c),i=e(45),o=e(2),s=e(13),u=e(136),l=e(282),d=e.n(l);console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/neural-food-web",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,API_ENDPOINT:"https://khmilevoi.github.io/neural-food-backend/"}));var b,f,h,j,p={endpoint:"https://khmilevoi.github.io/neural-food-backend/"},x=function(t){return new URL(t,p.endpoint).href},O={model:x("/model"),labels:x("/labels")},v={model:function(){var t=Object(i.a)(a.a.mark((function t(n,e){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.get(O.model,{cancelToken:e,onDownloadProgress:n});case 2:return r=t.sent,t.abrupt("return",r.data);case 4:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),labels:function(){var t=Object(i.a)(a.a.mark((function t(n,e){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.get(O.labels,{cancelToken:e,onDownloadProgress:n});case 2:return r=t.sent,t.abrupt("return",r.data);case 4:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}()},m=Object(o.b)("loader/load-model",function(){var t=Object(i.a)(a.a.mark((function t(n,e){var c,i,o,l,d;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.entity,i=n.nextStage,e.dispatch(r.a.actions.changeStatus("progress")),o=function(t){var n=100*t.loaded/t.total;setTimeout((function(){e.dispatch(r.a.actions.setProgress(Math.floor(n)))}),300)},"model"!==c){t.next=8;break}return t.next=6,v.model(o);case 6:l=t.sent,e.dispatch(s.clientSlice.actions.setModel(l));case 8:if("labels"!==c){t.next=13;break}return t.next=11,v.labels(o);case 11:d=t.sent,e.dispatch(s.clientSlice.actions.setLabels(d));case 13:e.dispatch(r.a.actions.changeStatus("default")),e.dispatch(Object(u.a)({stage:i,ms:1e3}));case 15:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}()),g=e(10),w=e(11),y=w.b.div(b||(b=Object(g.a)(["\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n"]))),k=w.b.div(f||(f=Object(g.a)([""]))),S=w.b.div(h||(h=Object(g.a)(["\n    width: 100px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n"]))),P=w.b.span(j||(j=Object(g.a)(["\n    margin-top: 10px;\n"]))),T=e(0),E=e(300),C=(e(301),e(3)),L=e(1),R=function(t){var n=t.action,e=t.title,c=Object(C.b)();T.useEffect((function(){c(n())}),[c,n]);var a=Object(r.b)();return Object(L.jsx)(k,{children:Object(L.jsxs)(S,{children:[Object(L.jsx)(E.a,{value:a.progress,text:"".concat(a.progress,"%")}),Object(L.jsx)(P,{children:e})]})})},_=e(166),A={"load-model":function(){return m({entity:"model",nextStage:"load-labels"})},"load-labels":function(){return m({entity:"labels",nextStage:"camera"})}},D={"load-model":"Load model","load-labels":"Load labels"};n.default=function(t){var n=t.stage,e=Object(C.b)();return T.useEffect((function(){e(r.a.actions.setProgress(0))}),[e,n]),Object(L.jsx)(_.a,{children:Object(L.jsx)(y,{children:Object(L.jsx)(R,{action:A[n],title:D[n]})})})}},341:function(t,n,e){"use strict";e.r(n);var r,c,a,i,o,s,u,l,d,b,f,h,j,p=e(135),x=e(37),O=e(0),v=function(t,n,e){return t<n?n:t>e?e:t},m=e(10),g=e(11),w=g.b.div(r||(r=Object(m.a)(["\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    transition: 0.1s;\n"]))),y=g.b.div(c||(c=Object(m.a)(["\n    height: ","px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-radius: 99999px 99999px 0 0;\n    background-color: white;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);\n"])),(function(t){return t.height})),k=g.b.div(a||(a=Object(m.a)(["\n    width: 50px;\n    height: 5px;\n    border-radius: 99999px;\n    background-color: silver;\n    cursor: pointer;\n"]))),S=g.b.div(i||(i=Object(m.a)(["\n    background-color: white;\n    display: flex;\n    flex-direction: column;\n    height: calc(100% - ","px);\n    overflow-y: auto;\n    padding-top: 15px;\n"])),(function(t){return t.header})),P=e(1),T=function(t){var n=t.containerHeight,e=t.children,r=O.useRef(null),c=function(t,n){var e=O.useState("default"),r=Object(x.a)(e,2),c=r[0],a=r[1],i=O.useState(t),o=Object(x.a)(i,2),s=o[0],u=o[1],l=O.useCallback((function(){a("start")}),[a]),d=O.useCallback((function(){var e=Math.abs(n-s),r=Math.abs(t-s);e<r&&u(n),r<e&&u(t),a("default")}),[s,u,a,n,t]),b=O.useCallback((function(e){a("move");var r=e.targetTouches.item(0),c=n-v(r.pageY,0,n-t);u(c)}),[a,u,n,t]);return[O.useCallback((function(t){switch(t){case"move":return b;case"end":return d;case"start":return l}}),[l,b,d]),s,c]}(355,n),a=Object(x.a)(c,2),i=a[0],o=a[1];return O.useEffect((function(){r.current&&(r.current.style.top="calc(100% - ".concat(o,"px)"))}),[o,r]),Object(P.jsxs)(w,{ref:r,children:[Object(P.jsx)(y,{height:55,onTouchStart:i("start"),onTouchEnd:i("end"),onTouchMove:i("move"),children:Object(P.jsx)(k,{})}),Object(P.jsx)(S,{header:55,children:e})]})},E=e(13),C=e(136),L=e(302),R=e(166),_=e(3),A=g.b.div(o||(o=Object(m.a)(["\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    position: relative;\n"]))),D=g.b.div(s||(s=Object(m.a)(["\n    position: absolute;\n    top: 20px;\n    left: 15px;\n    color: white;\n    z-index: 1000;\n    font-size: 30px;\n"]))),U=g.b.img(u||(u=Object(m.a)(["\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n"]))),F=g.b.div(l||(l=Object(m.a)(["\n    display: flex;\n    position: relative;\n"]))),H=g.b.img(d||(d=Object(m.a)(["\n    width: 40%;\n    height: 100px;\n    object-fit: cover;\n"]))),I=g.b.div(b||(b=Object(m.a)(["\n    padding: 0 15px;\n"]))),M=g.b.div(f||(f=Object(m.a)(["\n    font-size: 20px;\n"]))),N=g.b.div(h||(h=Object(m.a)(["\n    color: silver;\n"]))),z=g.b.div(j||(j=Object(m.a)([""]))),K=function(t){var n=t.list;return Object(P.jsx)(P.Fragment,{children:n.map((function(t){return Object(P.jsxs)(F,{children:[Object(P.jsx)(H,{src:t.label.image}),Object(P.jsxs)(I,{children:[Object(P.jsx)(z,{children:Object(P.jsx)(M,{children:t.label.title})}),Object(P.jsx)(z,{children:Object(P.jsxs)(N,{children:["Accuracy: ",(100*t.accuracy).toFixed(3),"%"]})})]})]},t.label.title)}))})};n.default=function(){var t=E.useClient(),n=L.usePredictions(t.model,t.snapshot,t.labels),e=Object(_.b)(),r=O.useCallback((function(){e(Object(C.a)({stage:"camera",ms:0}))}),[e]);return null==t.snapshot||null==t.model?null:Object(P.jsx)(R.a,{children:Object(P.jsxs)(A,{children:[Object(P.jsx)(D,{onClick:r,children:Object(P.jsx)(p.a,{})}),Object(P.jsx)(U,{src:URL.createObjectURL(t.snapshot)}),Object(P.jsx)(T,{containerHeight:window.innerHeight,children:Object(P.jsx)(K,{list:n})})]})})}}}]);
//# sourceMappingURL=loading.b4a71e17.chunk.js.map